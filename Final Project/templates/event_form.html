{% extends "base.html" %}
{% block content %}

<!-- Flatpickr CSS & JS for datetime picker -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

<div class="row justify-content-center">
  <div class="col-md-8 col-lg-7">
    <div class="card shadow-sm p-4">
      <h2 class="mb-4 text-primary fw-bold">
        {{ form_title or "Create Event" }}
      </h2>

      <form method="POST" enctype="multipart/form-data" id="event-form">
        {{ form.hidden_tag() }}

        <!-- TITLE -->
        <div class="mb-3">
          {{ form.title.label(class="form-label") }}
          {{ form.title(class="form-control") }}
          {% for error in form.title.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>

        <!-- DESCRIPTION (Quill + hidden textarea) -->
        <div class="mb-3">
          {{ form.description.label(class="form-label") }}

          {{ form.description(class="form-control d-none", id="description-hidden") }}

          <div id="quill-editor"
               style="min-height: 150px; background-color: #ffffff; border-radius: 0.375rem;">
          </div>

          {% for error in form.description.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>

        <!-- IMAGE UPLOAD -->
        <div class="mb-3">
          {{ form.image.label(class="form-label") }}
          {{ form.image(class="form-control") }}
          {% for error in form.image.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>

        <!-- LOCATION -->
        <div class="mb-3">
          {{ form.location.label(class="form-label") }}
          {{ form.location(class="form-control") }}
          {% for error in form.location.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>

        <!-- START / END TIME -->
        <div class="row">
          <div class="col-md-6 mb-3">
            {{ form.start_time.label(class="form-label") }}
            {{ form.start_time(class="form-control", placeholder="05-01-2025 03:00 PM") }}
            {% for error in form.start_time.errors %}
              <div class="text-danger small">{{ error }}</div>
            {% endfor %}
          </div>
          <div class="col-md-6 mb-3">
            {{ form.end_time.label(class="form-label") }}
            {{ form.end_time(class="form-control", placeholder="05-01-2025 06:00 PM") }}
            {% for error in form.end_time.errors %}
              <div class="text-danger small">{{ error }}</div>
            {% endfor %}
          </div>
        </div>

        <!-- CLUB SELECT -->
        <div class="mb-3">
          {{ form.club_id.label(class="form-label") }}
          {{ form.club_id(class="form-select") }}
          {% for error in form.club_id.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>

        <!-- BUTTONS -->
        <button type="submit" class="btn btn-primary">
          Save Event
        </button>
        <a href="{{ url_for('events') }}" class="btn btn-link">
          Cancel
        </a>
      </form>
    </div>
  </div>
</div>

<!-- Flatpickr JS for datetime picker -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.js" defer></script>
<script defer>
  document.addEventListener('DOMContentLoaded', function() {
    // Initialize start time picker
    flatpickr('#start_time', {
      enableTime: true,
      dateFormat: 'm-d-Y h:i K',
      time_24hr: false,
      minuteIncrement: 15,
      placeholder: '05-01-2025 03:00 PM'
    });
    
    // Initialize end time picker
    flatpickr('#end_time', {
      enableTime: true,
      dateFormat: 'm-d-Y h:i K',
      time_24hr: false,
      minuteIncrement: 15,
      placeholder: '05-01-2025 06:00 PM'
    });
  });
</script>

{% endblock %}
